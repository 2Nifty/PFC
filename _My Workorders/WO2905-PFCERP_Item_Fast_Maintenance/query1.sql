
---------------------------------------------------------------------------


drop table tXLSImport

SELECT	* --into tXLSImportFROM	OpenRowSet(	'Microsoft.Jet.OLEDB.4.0',					'Excel 8.0;Database=c:\SelectedSKU.xls;IMEX=1',					'select * from [SelectedSKU434418$]')SELECT * --INTO [t_20120502_IMFastMaint0215486] into tXLSImportFROM OpenRowSet('Microsoft.Jet.OLEDB.4.0',				'Excel 8.0;Database=c:\FastMaint.xls;IMEX=1',				'SELECT * FROM [IMFastMaint$]')select *from tXLSImportdeclare @FieldName varchar(50);set @FieldName = (select top 1 UpdateField from tXLSImport)select @FieldName as FieldNameSELECT	* FROM	OpenRowSet('Microsoft.Jet.OLEDB.4.0',					'Excel 8.0;Database=\\pfcfiles\userdb\SelectedSKU.xls;IMEX=1',					'select * from [SelectedSKU434418$]')alter table tXLSImport change 'MOD: Category Desc|CatDesc|test' 'CatDesc'exec sp_columns tXLSImportSELECT	*FROM	tXLSImportWHERE	isnull(CatDesc,'') <> ''UPDATE	ItemMasterSET		CatDesc = UPD.CatDesc,		ChangeDt = CAST (FLOOR (CAST (GetDate() AS FLOAT)) AS DATETIME),		ChangeID = 'xWO2905'FROM	(SELECT	*		 FROM	tXLSImport		 WHERE	isnull(CatDesc,'') <> '') UPDWHERE	ItemMaster.ItemNo = UPD.[Item No]SELECT * --INTO [t_20120503_IMFastMaint0215492]FROM OpenRowSet('Microsoft.Jet.OLEDB.4.0', 'Excel 8.0;Database=\\pfcfiles\ItemFastMaint\FastMaint.xls;IMEX=1', 'SELECT * FROM [IMFastMaint$]')update itemmaster set changeid='', changedt=''where pitemmasterid in(select	pitemmasterid		--changedt, changeid, *from ItemMaster where ChangeDt > getdate()-1)select * from ItemMaster where left(itemno,5)='00400' order by ItemNoSELECT * --INTO [t_20120509_IMFastMaint02Update15545tod_CatDesc] FROM OpenRowSet('Microsoft.ACE.OLEDB.12.0', 'Excel 12.0;Database=\\pfcfiles\ItemFastMaint\IMFastMaint02Import15545tod.xls;IMEX=1', 				'SELECT	[Item] as ItemNo,						[Orig: Category Desc] as Orig_CatDesc,						[Mod: Category Desc] as CatDesc				 FROM	[CatDesc]				WHERE	isnull([Mod: Category Desc],'') <> '' AND isnull([Orig: Category Desc],'') <> isnull([Mod: Category Desc],'')')SELECT * INTO [t_20120509_IMFastMaint02Update15545tod_CatDesc] FROM OpenRowSet('Microsoft.ACE.OLEDB.12.0', 'Excel 12.0;Database=\\pfcfiles\ItemFastMaint\IMFastMaint02Import15545tod.xls;IMEX=1', 'SELECT [Item] as ItemNo, [Orig: Category Desc] as Orig_CatDesc, [Mod: Category Desc] as CatDesc FROM [CatDesc] WHERE 1=1')SELECT * INTO [t_20120509_IMFastMaint02Update15545tod_CatDesc] FROM OpenRowSet('Microsoft.ACE.OLEDB.12.0', 'Excel 12.0;Database=\\pfcfiles\ItemFastMaint\IMFastMaint02Import15545tod.xls;IMEX=1', 'SELECT [Item] as ItemNo, [Orig: Category Desc] as Orig_CatDesc, [Mod: Category Desc] as CatDesc FROM [CatDesc] WHERE isnull([Mod: Category Desc],'''') <> '''' AND isnull([Orig: Category Desc],'''') <> isnull([Mod: Category Desc],'''')')